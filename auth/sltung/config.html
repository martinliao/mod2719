<?php
    global $OUTPUT;
    // set to defaults if undefined
    if (!isset($config->authhost)) {
        //$config->authurl = 'http://eip.sltung.com.tw/EIP/service/SSO/chkUserPwd.php';
        $config->authhost = 'eip.sltung.com.tw';
    }
    if (!isset($config->authurl)) {
        $config->authurl = '/EIP/service/SSO/chkUserPwd.php';
    }
    
    if (!isset($config->ssohost)) {
        //http://10.6.51.133/EIP/service/KM/verifyAuth.php
        $config->ssohost = '10.6.51.133';
    }
    if (!isset($config->ssourl)) {
        $config->ssourl = '/EIP/service/KM/verifyAuth.php';
    }
    
    if (!isset($config->fielduser)) {
        $config->fielduser = '';
    }
    
    if (!isset($config->perzurl)) {
        $config->perzurl = 'http://eip.sltung.com.tw/EIP/gows.php?wtag=pvt.eln.getempinfo';
    }
    if (!isset($config->var)) {
        $config->var = 'eyJkbyI6IjEifQ==';
    }

    

    if (!isset($config->changepasswordurl)) {
        $config->changepasswordurl = '';
    }
    if (empty($config->extencoding)) {
        $config->extencoding = 'utf-8';
    }
    if (empty($config->debugauthdb)) {
        $config->debugauthdb = 0;
    }
    if (!isset($config->removeuser)) {
        $config->removeuser = AUTH_REMOVEUSER_KEEP;
    }

    $yesno = array( get_string('no'), get_string('yes') );

?>
<table cellspacing="0" cellpadding="5" border="0">

<tr valign="top" class="required">
    <td align="right"><label for="authhost"><?php print_string("auth_authhost_key", "auth_sltung") ?></label></td>
    <td>
        <input id="authhost" name="authhost" type="text" size="30" value="<?php echo $config->authhost?>" />
        <?php

        if (isset($err["authhost"])) {
            echo $OUTPUT->error_text($err["authhost"]);
        }

        ?>
    </td>
    <td><?php print_string("auth_authhost", "auth_sltung") ?></td>
</tr>
<tr valign="top" class="required">
    <td align="right"><label for="authurl"><?php print_string("auth_authurl_key", "auth_sltung") ?></label></td>
    <td>
        <input id="authurl" name="authurl" type="text" size="30" value="<?php echo $config->authurl?>" />
        <?php

        if (isset($err["authurl"])) {
            echo $OUTPUT->error_text($err["authurl"]);
        }

        ?>
    </td>
    <td><?php print_string("auth_authurl", "auth_sltung") ?></td>
</tr>

<tr valign="top" class="required">
    <td align="right"><label for="ssohost"><?php print_string("auth_ssohost_key", "auth_sltung") ?></label></td>
    <td>
        <input id="ssohost" name="ssohost" type="text" size="30" value="<?php echo $config->ssohost?>" />
        <?php

        if (isset($err["ssohost"])) {
            echo $OUTPUT->error_text($err["ssohost"]);
        }

        ?>
    </td>
    <td><?php print_string("auth_ssohost", "auth_sltung") ?></td>
</tr>
<tr valign="top" class="required">
    <td align="right"><label for="ssourl"><?php print_string("auth_ssourl_key", "auth_sltung") ?></label></td>
    <td>
        <input id="ssourl" name="ssourl" type="text" size="30" value="<?php echo $config->ssourl?>" />
        <?php

        if (isset($err["ssourl"])) {
            echo $OUTPUT->error_text($err["ssourl"]);
        }

        ?>
    </td>
    <td><?php print_string("auth_ssourl", "auth_sltung") ?></td>
</tr>


<tr valign="top" class="required">
    <td align="right"><label for="perzurl"><?php print_string("auth_perzurl_key", "auth_sltung") ?></label></td>
    <td>
        <input id="perzurl" name="perzurl" type="text" size="30" value="<?php echo $config->perzurl?>" />
        <?php

        if (isset($err["perzurl"])) {
            echo $OUTPUT->error_text($err["perzurl"]);
        }

        ?>
    </td>
    <td><?php print_string("auth_perzurl", "auth_sltung") ?></td>
</tr>


<tr valign="top" class="required">
    <td align="right"><label for="var"><?php print_string("auth_var_key", "auth_sltung") ?></label></td>
    <td>
        <input id="var" name="var" type="password" size="30" value="<?php p($config->var)?>" autocomplete="off"/>
        <?php

        if (isset($err["var"])) {
            echo $OUTPUT->error_text($err["var"]);
        }

        ?>
    </td>
    <td>
    <?php print_string("auth_var", "auth_sltung") ?>
    </td>
</tr>

<tr valign="top" class="required">
    <td align="right"><label for="fielduser"><?php print_string("auth_fielduser_key", "auth_sltung") ?></label></td>
    <td>
        <input id="fielduser" name="fielduser" type="text" size="30" value="<?php echo $config->fielduser?>" />
        <?php

        if (isset($err["fielduser"])) {
            echo $OUTPUT->error_text($err["fielduser"]);
        }

        ?>
    </td>
    <td><?php print_string("auth_fielduser", "auth_sltung") ?></td>
</tr>

<tr valign="top" class="required">
    <td align="right"><label for="extencoding"><?php print_string("auth_dbextencoding", "auth_sltung") ?></label></td>
    <td>
        <input id="extencoding" name="extencoding" type="text" value="<?php echo $config->extencoding ?>" />
        <?php

        if (isset($err['extencoding'])) {
            echo $OUTPUT->error_text($err['extencoding']);
        }

        ?>
    </td>
    <td><?php print_string('auth_dbextencodinghelp', 'auth_sltung') ?></td>
</tr>

<tr valign="top">
    <td align="right"><label for="menudebugauthdb"><?php print_string("auth_dbdebugauthdb", "auth_sltung") ?></label></td>
    <td>
        <?php echo html_writer::select($yesno, 'debugauthdb', $config->debugauthdb, false); ?>
    </td>
    <td><?php print_string("auth_dbdebugauthdbhelp", "auth_sltung") ?></td>
</tr>

<tr valign="top">
    <td align="right"><label for="changepasswordurl"><?php print_string("auth_dbchangepasswordurl_key", "auth_sltung") ?></label></td>
    <td>
        <input id="changepasswordurl" name="changepasswordurl" type="text" value="<?php echo $config->changepasswordurl ?>" />
        <?php

        if (isset($err['changepasswordurl'])) {
            echo $OUTPUT->error_text($err['changepasswordurl']);
        }

        ?>
    </td>
    <td><?php print_string('changepasswordhelp', 'auth') ?></td>
</tr>

<tr>
   <td colspan="2">
        <h4><?php print_string('auth_sync_script', 'auth') ?> </h4>
   </td>
</tr>

<tr valign="top">
    <td align="right"><label for="menuremoveuser"><?php print_string('auth_remove_user_key','auth') ?></label></td>
    <td>
    <?php
       $deleteopt = array();
       $deleteopt[AUTH_REMOVEUSER_KEEP] = get_string('auth_remove_keep','auth');
       $deleteopt[AUTH_REMOVEUSER_SUSPEND] = get_string('auth_remove_suspend','auth');
       $deleteopt[AUTH_REMOVEUSER_FULLDELETE] = get_string('auth_remove_delete','auth');
       echo html_writer::select($deleteopt, 'removeuser', $config->removeuser, false);
    ?>
    </td>
    <td>
    <?php print_string('auth_remove_user','auth') ?>
    </td>
</tr>

<?php

print_auth_lock_options($this->authtype, $user_fields, get_string('auth_dbextrafields', 'auth_sltung'), true, true);

?>
</table>
